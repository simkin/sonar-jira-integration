Forked and edited to be better compatible with personal work environment
